<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <link href="https://fonts.googleapis.com/css?family=Material+Icons&display=block" rel="stylesheet">
  </head>
  <body style="margin: 0">
    <script type="module">
    </script>
    <kerk-planning></kerk-planning>
    <script>
        const kp = document.querySelector('kerk-planning');
        google.script.run.withSuccessHandler(result => kp.gebouwen = result).getGebouwen();
        google.script.run.withSuccessHandler(result => kp.deelnemers = result).getDeelnemers();
        kp.ophalen = (datum, dienst, handler) => { google.script.run.withSuccessHandler(handler).ophalen(datum, dienst); };
        kp.opslaan = (planning, handler) => { google.script.run.withSuccessHandler(handler).opslaan(planning); };
        kp.uitnodigen = (planning, handler) => { google.script.run.withSuccessHandler(result => {
          handler(result);
          google.script.run.withSuccessHandler(result => kp.deelnemers = result).getDeelnemers();
        }).uitnodigen(planning); };
    </script>
  </body>
</html>
